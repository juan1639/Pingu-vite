var e=Object.defineProperty,t=(t,s,o)=>(((t,s,o)=>{s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[s]=o})(t,"symbol"!=typeof s?s+"":s,o),o);import{p as s}from"./phaser-cxBNu8M8.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const s of e)if("childList"===s.type)for(const e of s.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const o=class e{static getLayer1(){return e.layer1}static getTxtScore(){return e.txtScore}static isNivelSuperado(){return e.pausas.nivelSuperado.superado}static isPausaInicial(){return e.pausas.inicial}static getPausaNivelSuperado(){return e.pausas.nivelSuperado.duracion}static isGameOver(){return e.gameOver}static getPuntos(){return e.puntos}static getNivel(){return e.nivel}static getRecord(){return e.hi}static getVidas(){return e.vidas}static getVelJugador(){return e.velJugador}static isJugadorMoving(){return e.jugador.moving}static getCameraScores(){return e.cameraScores}static getCameraControles(){return e.cameraControles}static setLaye1ScaleX(t){e.layer1.scaleX=t}static setLaye1ScaleY(t){e.layer1.scaleY=t}static setNivelSuperado(t){e.pausas.nivelSuperado.superado=t}static setGameOver(t){e.gameOver=t}static setPuntos(t){e.puntos=t}static setNivel(t){e.nivel=t}static setRecord(t){e.hi=t}static setVidas(t){e.vidas=t}static setJugadorMoving(t){e.jugador.moving=t}static setPausaInicial(t){e.pausas.inicial=t}};t(o,"controlElegido",{mobile:!1,teclado:!0}),t(o,"screen",{width:800,height:550,escBoundsX:1.1,escBoundsY:1.25}),t(o,"tileXY",{x:48,y:48}),t(o,"layer1",{scaleX:1,scaleY:1}),t(o,"gameOver",!1),t(o,"puntos",0),t(o,"nivel",1),t(o,"hi",12e3),t(o,"vidas",3),t(o,"txtScore"," Score: "),t(o,"velJugador",4),t(o,"jugador",{posIniX:9,posIniY:7,oriX:.5,oriY:.5,velX:o.velJugador,velY:o.velJugador,moving:!1,direccion:{le:[-1,0,0,"le"],ri:[1,0,0,"ri"],up:[0,-1,0,"up"],do:[0,1,0,"do"]},teclas:{le:"left",ri:"right",up:"up",do:"down"}}),t(o,"bloques",{vel:200,velPxl:4,breakDuration:900}),t(o,"mideTiempo",[null,null,200]),t(o,"incGodownInvaders",[2,2,4,5,8,10,12,15,18,20,22,25,28,30,30,30,30,30,30,30,30]),t(o,"pausas",{inicial:!1,revivir:4e3,invisible:3e3,showBonus:3500,nivelSuperado:{superado:!1,duracion:3200},duracionExplosion:{jugador:1e3,enemigo:400}}),t(o,"depth",{fondo:-900,bloques:-800,limites:-700,jugador:-600,enemigo:-500,explosiones:-400,marcadores:-300,botones:-200,botonesTxt:-150,textos:-100,mobileControls:-50}),t(o,"cameraScores",{x:0,y:0,ancho:800,alto:34,scrollX:0,scrollY:-90}),t(o,"cameraControles",{x:Math.floor(o.screen.width/1.3),y:Math.floor(o.screen.height/1.4),ancho:270,alto:270,scrollX:Math.floor(o.screen.width/1.3),scrollY:-600}),t(o,"audio",{monedaMario:null,musicaFondo:null});let i=o;class a{constructor(e,t){this.relatedScene=e,this.datos=t}create(){const{x:e,y:t,txt:s,size:o,color:i,style:a,stroke:r,sizeStroke:n,shadowOsx:l,shadowOsy:h,shadowColor:d,bool1:c,bool2:g,origin:u,elastic:m,dura:p}=this.datos;this.texto=this.relatedScene.add.text(e,t,s,{fontSize:o+"px",fill:i,fontFamily:"verdana, arial, sans-serif",fontStyle:a}),this.texto.setOrigin(u[0],u[1]),this.texto.setStroke(r,n),this.texto.setShadow(l,h,d,2,c,g),this.elastic(s,m,p),console.log(this.texto)}elastic(e,t,s){s>0&&this.relatedScene.tweens.add({targets:this.texto,y:t,ease:"Elastic",duration:s})}get(){return this.texto}}class r extends s.Scene{constructor(){super("Boot")}init(){this.txt=new a(this,{x:Math.floor(this.sys.game.config.width/2),y:Math.floor(this.sys.game.config.height/2),txt:" Touch screen or \n \n click to start... ",size:60,color:"#ffa",style:"bold",stroke:"#1e9",sizeStroke:16,shadowOsx:2,shadowOsy:2,shadowColor:"#111",bool1:!1,bool2:!0,origin:[.5,.5],elastic:!1,dura:0})}preload(){this.load.image("fondo","assets/img/bg.png")}create(){this.add.image(0,0,"fondo").setOrigin(0,0),this.txt.create(),this.input.on("pointerdown",(()=>this.scene.start("Preloader"))),console.log(this.txt)}}class n extends s.Scene{constructor(){super("Preloader")}init(){const e=this.sys.game.config.width,t=this.sys.game.config.height;this.load.image("fondo","assets/img/bg.png"),this.add.image(0,0,"fondo").setOrigin(0,0),this.txt=new a(this,{x:Math.floor(e/2),y:Math.floor(t/3.5),txt:" Loading...",size:55,color:"#ffa",style:"bold",stroke:"#f91",sizeStroke:16,shadowOsx:2,shadowOsy:2,shadowColor:"#111",bool1:!1,bool2:!0,origin:[.5,.5],elastic:!1,dura:0}),this.txt.create(),this.add.rectangle(Math.floor(e/2),Math.floor(t/2),Math.floor(e/1.5),Math.floor(t/12)).setStrokeStyle(1,16772744);const s=this.add.rectangle(Math.floor(e/2)-Math.floor(e/3)+4,Math.floor(t/2),4,Math.floor(t/14),16750865);this.load.on("progress",(t=>{s.width=Math.floor(e/1.52)*t}))}preload(){this.load.setPath("assets"),this.load.image("fondo","./img/bg.png"),this.load.image("boton-nueva-partida","./img/ui-newgame.png"),this.load.image("boton-fire-joystick","./img/ui-1.png"),this.load.spritesheet("radio-buttons","./img/radio-buttons-lightblue.png",{frameWidth:50,frameHeight:50}),this.load.spritesheet("boton-fullscreen","./img/boton-fullscreen.png",{frameWidth:64,frameHeight:64});for(let e=1;e<5;e++)this.load.image(`tile${e}`,`./img/tile${e}.png`);this.load.atlas("tiles-jewels","./img/jewels.png","./img/jewels.json"),this.load.spritesheet("tile-broken","./img/tile-broken-ssheet.png",{frameWidth:64,frameHeight:64}),this.load.spritesheet("pengo-ssheet","./img/pengo-ssheet.png",{frameWidth:50,frameHeight:52}),this.load.plugin("rexvirtualjoystickplugin","https://raw.githubusercontent.com/rexrainbow/phaser3-rex-notes/master/dist/rexvirtualjoystickplugin.min.js",!0),this.load.audio("gameover-retro","./audio/gameoveretro.ogg"),this.load.audio("get-ready","./audio/get-ready.mp3"),this.load.audio("ziuuu","./audio/jumpbros.ogg"),this.load.audio("moneda-mario","./audio/p-ping.mp3"),this.load.audio("ziuuu1","./audio/slide-whistle-1.mp3"),this.load.audio("ziuuu2","./audio/slide-whistle-2.mp3"),this.load.audio("musica-fondo","./audio/musica-fondo.mp3"),this.load.audio("mario-tuberias","./audio/mario-tuberias.ogg"),this.load.audio("crash","./audio/crash.mp3")}create(){this.scene.start("MainMenu")}}class l{}t(l,"array_levels",[[[9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9],[9,1,1,1,1,1,1,1,1,9,1,1,1,1,1,1,1,1,9],[9,1,9,9,1,9,9,9,1,9,1,9,9,9,1,9,9,1,9],[9,1,9,9,1,9,9,9,1,9,1,9,9,9,1,9,9,1,9],[9,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,9],[9,1,9,9,1,9,1,9,9,9,9,9,1,9,1,9,9,1,9],[9,1,1,1,1,9,1,1,1,9,1,1,1,9,1,1,1,1,9],[9,9,9,9,1,9,9,9,1,9,1,9,9,9,1,9,9,9,9],[9,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,9],[9,1,9,9,1,9,1,9,1,9,1,9,1,9,1,9,9,1,9],[9,1,9,9,1,9,1,9,1,9,1,9,1,9,1,9,9,1,9],[9,1,1,1,1,9,1,1,1,1,1,1,1,9,1,1,1,1,9],[9,1,9,9,1,9,1,9,9,9,9,9,1,9,1,9,9,1,9],[9,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,9],[9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9]],[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,6,1,6,6,6,1,6,6,6,6,6,1,6,6,6,6,6,1],[1,6,1,6,1,1,1,1,1,1,1,6,1,6,1,1,1,6,1],[1,6,6,6,1,6,6,6,6,6,1,6,1,6,6,6,6,6,1],[1,6,1,1,1,6,1,1,1,6,1,6,1,6,1,1,1,6,1],[1,6,6,6,6,6,1,6,6,6,1,6,6,6,6,6,1,6,1],[1,1,1,1,1,1,1,6,1,1,1,6,1,1,1,6,1,6,1],[1,6,6,6,6,6,6,6,1,6,6,6,6,6,1,6,1,6,1],[1,6,1,1,1,1,1,6,1,6,1,1,1,1,1,6,1,6,1],[1,6,1,6,6,6,6,6,1,6,1,6,6,6,6,6,6,6,1],[1,6,1,6,1,1,1,1,1,6,1,1,1,1,6,1,1,6,1],[1,6,6,6,6,6,6,6,1,6,6,6,6,6,6,6,1,6,1],[1,1,1,1,1,1,1,6,1,1,1,1,1,1,1,6,1,6,1],[1,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]]]);class h{constructor(e,t){this.relatedScene=e,this.args=t}create(){const{x:e,y:t,oriX:s,oriY:o}=this.args;this.jugador=this.relatedScene.physics.add.sprite(e,t,"pengo-ssheet"),this.jugador.setOrigin(s,o),this.jugador.setAngle(0).setDepth(i.depth.jugador).setScale(.9),this.jugador.setCircle(Math.floor(i.tileXY.y/2)),this.jugador.setData("direccion","ri"),this.jugador.setData("anima",this.jugador.getData("direccion"));const a=[["le",2,3],["ri",6,7],["up",4,5],["do",0,1]];for(let i=0;i<a.length;i++)this.relatedScene.anims.create({key:a[i][0],frames:this.relatedScene.anims.generateFrameNumbers("pengo-ssheet",{start:a[i][1],end:a[i][2]}),frameRate:5,yoyo:!0,repeat:-1});this.relatedScene.anims.create({key:"turn",frames:[{key:"pengo-ssheet",frame:23}],frameRate:20}),this.jugador.anims.play(this.jugador.getData("anima"),!0),this.controles=this.relatedScene.input.keyboard.createCursorKeys(),console.log(this.jugador)}update(){this.jugador.x%i.tileXY.x==0&&this.jugador.y%i.tileXY.y==0&&(i.setJugadorMoving(!1),this.viejaX=this.jugador.x,this.viejaY=this.jugador.y),i.jugador.direccion,i.isJugadorMoving()?this.set_velocity():(Object.keys(i.jugador.direccion).forEach((e=>{const t=i.jugador.teclas[e];(this.controles[t].isDown||this.relatedScene.joystickCursors[t].isDown)&&(i.setJugadorMoving(!0),this.jugador.setData("direccion",e),this.jugador.setData("anima",this.jugador.getData("direccion")),this.jugador.anims.play(this.jugador.getData("anima"),!0),this.jugador.setAngle(i.jugador.direccion[this.jugador.getData("direccion")][2]),this.set_velocity())})),this.controles.space.isDown)}set_velocity(){const e=i.jugador.direccion[this.jugador.getData("direccion")][0],t=i.jugador.direccion[this.jugador.getData("direccion")][1];this.jugador.x+=e*i.jugador.velX,this.jugador.y+=t*i.jugador.velY}handlePushBlock(){const e=Math.floor(this.jugador.x/i.tileXY.x)+i.jugador.direccion[this.jugador.getData("direccion")][0],t=Math.floor(this.jugador.y/i.tileXY.y)+i.jugador.direccion[this.jugador.getData("direccion")][1],s=i.getNivel();6!==l.array_levels[s][t][e]&&console.log(`empujar:${t}${e}`);const o=this.jugador.x+i.jugador.direccion[this.jugador.getData("direccion")][0]*i.tileXY.x,a=this.jugador.y+i.jugador.direccion[this.jugador.getData("direccion")][1]*i.tileXY.y;this.relatedScene.jewels.get().children.iterate(((e,t)=>{o===e.x&&a===e.y&&console.log("empujarJewel"+t)}))}get(){return this.jugador}}class d{constructor(e,t){this.relatedScene=e,this.args=t}create(){const{left:e,top:t}=this.args;this.jugadorshowvidas=this.relatedScene.physics.add.group({key:["pacman"],frameQuantity:i.getVidas(),setXY:{x:e,y:t,stepX:i.tileXY.x},frame:4}),this.jugadorshowvidas.children.iterate((e=>{e.setOrigin(.5,0).setScale(1,.7).setBlendMode(Phaser.BlendModes.ADD)})),console.log(this.jugadorshowvidas)}get(){return this.jugadorshowvidas}}class c{constructor(e,t){this.relatedScene=e,this.args=t}create(){const{x:e,y:t,oriX:s,oriY:o}=this.args;this.jugadorpregame=this.relatedScene.physics.add.sprite(e,t,"pengo-ssheet"),this.jugadorpregame.setOrigin(s,o),this.jugadorpregame.setAngle(0).setDepth(i.depth.jugador).setScale(1.2),this.jugadorpregame.setData("direccion","ri"),this.jugadorpregame.setData("anima",this.jugadorpregame.getData("direccion")),this.jugadorpregame.setVelocityX(90),this.currentAnima=0;const a=[["le",2,3],["ri",6,7],["up",4,5],["do",0,1]];for(let i=0;i<a.length;i++)this.relatedScene.anims.create({key:a[i][0],frames:this.relatedScene.anims.generateFrameNumbers("pengo-ssheet",{start:a[i][1],end:a[i][2]}),frameRate:5,yoyo:!0,repeat:-1});this.relatedScene.anims.create({key:"culete",frames:this.relatedScene.anims.generateFrameNumbers("pengo-ssheet",{frames:[20,21]}),frameRate:5,yoyo:!0,repeat:2}),this.relatedScene.anims.create({key:"sentadilla",frames:this.relatedScene.anims.generateFrameNumbers("pengo-ssheet",{frames:[22,23]}),frameRate:5,yoyo:!0,repeat:2}),this.jugadorpregame.anims.play(this.jugadorpregame.getData("anima"),!0),console.log(this.jugadorpregame)}update(){this.jugadorpregame.x>=400&&0===this.currentAnima&&(this.currentAnima=1,this.jugadorpregame.anims.play("culete",!0),this.jugadorpregame.setVelocityX(0)),1!==this.currentAnima||this.jugadorpregame.anims.isPlaying||(this.currentAnima=2,this.jugadorpregame.anims.play("sentadilla",!0),this.jugadorpregame.setVelocityX(0)),2!==this.currentAnima||this.jugadorpregame.anims.isPlaying||(this.currentAnima=3,this.jugadorpregame.anims.play("ri",!0),this.jugadorpregame.setVelocityX(0))}get(){return this.jugadorpregame}}function g(e,t){if(this.jugador.controles.space.isDown||console.log("colision:"+t.getData("id")),this.jugador.controles.space.isDown&&i.controlElegido.teclado||i.controlElegido.mobile){let e=99;b(this.sonido_ziuuu,!1,.2),i.mideTiempo[0]=this.time.now,Object.values(i.jugador.teclas).forEach(((t,s)=>{(this.jugador.controles[t].isDown||this.joystickCursors[t].isDown)&&(e=s)})),console.log("empujando:"+t.getData("id"),e);const s=[[-1,0],[1,0],[0,-1],[0,1]];e>=0&&e<4&&(t.setData("vel-x",s[e][0]*i.bloques.velPxl),t.setData("vel-y",s[e][1]*i.bloques.velPxl))}this.jugador.get().setX(this.jugador.viejaX),this.jugador.get().setY(this.jugador.viejaY)}function u(e,t){if(this.jugador.controles.space.isDown||console.log("colision:"+t.getData("id")),this.jugador.controles.space.isDown&&i.controlElegido.teclado||i.controlElegido.mobile){let e=99;b(this.sonido_ziuuu,!1,.2),i.mideTiempo[0]=this.time.now,Object.values(i.jugador.teclas).forEach(((t,s)=>{(this.jugador.controles[t].isDown||this.joystickCursors[t].isDown)&&(e=s)})),console.log("empujando:"+t.getData("id"),e);const s=[[-1,0],[1,0],[0,-1],[0,1]];e>=0&&e<4&&(t.setData("vel-x",s[e][0]*i.bloques.velPxl),t.setData("vel-y",s[e][1]*i.bloques.velPxl))}this.jugador.get().setX(this.jugador.viejaX),this.jugador.get().setY(this.jugador.viejaY)}function m(e,t){e.setX(e.x+-e.getData("vel-x")),e.setY(e.y+-e.getData("vel-y")),e.setData("vel-x",0).setData("vel-y",0),i.mideTiempo[1]=this.time.now;const s=i.mideTiempo[2];if(i.mideTiempo[1]-i.mideTiempo[0]<s){console.log("romper!!");const t=i.tileXY.x-i.bloques.velPxl;y(e,this)===t&&(this.brokenblock.create(e.x,e.y,!1),e.disableBody(!0,!0),b(this.sonido_crash,!1,.6))}}function p(e,t){e.setX(e.x+-e.getData("vel-x")),e.setY(e.y+-e.getData("vel-y")),e.setData("vel-x",0).setData("vel-y",0),i.mideTiempo[1]=this.time.now;const s=i.mideTiempo[2];if(i.mideTiempo[1]-i.mideTiempo[0]<s){console.log("romper!!");const t=i.tileXY.x-i.bloques.velPxl;y(e,this)===t&&(this.brokenblock.create(e.x,e.y,!1),e.disableBody(!0,!0),b(this.sonido_crash,!1,.6))}}function f(e,t){e.setX(e.x+-e.getData("vel-x")),e.setY(e.y+-e.getData("vel-y")),e.setData("vel-x",0).setData("vel-y",0)}function y(e,t){return Math.abs(t.jugador.get().x-e.x)+Math.abs(t.jugador.get().y-e.y)}function b(e,t,s){e.volume=s,e.loop=t,e.play()}class x{constructor(e,t){this.relatedScene=e,this.args=t}create(){i.audio.monedaMario=this.relatedScene.sound.add("moneda-mario");const{left:e,top:t,id:s,scX:o,scY:r,angle:n,originX:l,originY:h,texto:d,nextScene:c}=this.args;this.boton=this.relatedScene.add.sprite(e,t,s).setInteractive(),this.boton.setScale(o,r).setAngle(1).setDepth(i.depth.botones),this.txt=new a(this.relatedScene,{x:e,y:t,txt:d,size:24,color:"#ff1",style:"bold",stroke:"#1bd",sizeStroke:16,shadowOsx:2,shadowOsy:2,shadowColor:"#111111",bool1:!1,bool2:!0,origin:[.5,.5],elastic:!1,dura:0}),this.txt.create(),this.txt.get().setDepth(i.depth.botonesTxt).setAlpha(1).setScale(1),this.boton.on("pointerover",(()=>{this.boton.setScale(o+.04,r+.04)})),this.boton.on("pointerout",(()=>{this.boton.setScale(o,r)})),this.boton.on("pointerdown",(e=>{b(i.audio.monedaMario,!1,.7),this.relatedScene.scene.start(c)})),this.relatedScene.tweens.add({targets:[this.boton,this.txt.get()],angle:359,ease:"Elastic",yoyo:!0,hold:3e3,duration:2e3,repeat:-1})}get(){return this.boton}}class j{constructor(e,t){this.relatedScene=e,this.args=t}create(){const{x:e,y:t,id:s,orX:o,orY:a,scX:r,scY:n,ang:l}=this.args;this.boton=this.relatedScene.add.image(e,t,s).setInteractive(),this.boton.setOrigin(o,a).setScale(r,n),this.boton.setAngle(l).setFrame(0).setDepth(i.depth.botones),this.boton.setX(e).setY(t),this.boton.on("pointerover",(()=>{this.boton.setScale(r+.1,n+.1)})),this.boton.on("pointerout",(()=>{this.boton.setScale(r,n)})),this.boton.on("pointerdown",(()=>{this.relatedScene.scale.isFullscreen?this.relatedScene.scale.stopFullscreen():this.relatedScene.scale.startFullscreen()}))}}class v{constructor(e,t){this.relatedScene=e,this.args=t}create(){const{left:e,top:t,id:s,scX:o,scY:r,angle:n,originX:l,originY:h,texto:d,nextScene:c}=this.args;this.boton=this.relatedScene.add.sprite(e,t,s).setInteractive(),this.boton.setOrigin(l,h).setScale(o,r).setAngle(n).setDepth(i.depth.botones),this.txt=new a(this.relatedScene,{x:e,y:t,txt:d,size:25,color:"#fb1",style:"bold",stroke:"#f81",sizeStroke:8,shadowOsx:2,shadowOsy:2,shadowColor:"#111111",bool1:!1,bool2:!0,origin:[.5,.5],elastic:!1,dura:0}),this.txt.create(),this.txt.get().setDepth(i.depth.botonesTxt).setAlpha(1).setScale(1),this.boton.on("pointerover",(()=>{this.boton.setScale(o+.03,r+.03)})),this.boton.on("pointerout",(()=>{this.boton.setScale(o,r)})),this.boton.on("pointerdown",(e=>{d.includes("Music")&&(i.audio.musicaFondo.volume>0?(i.audio.musicaFondo.volume=0,this.txt.get().setAlpha(.3)):(i.audio.musicaFondo.volume=.6,this.txt.get().setAlpha(1))),""!==c&&this.relatedScene.scene.start(c)}))}get(){return this.boton}}class w extends s.Scene{constructor(){super("MainMenu")}init(){this.marioTuberias=this.sound.add("mario-tuberias"),this.jugador=new c(this,{x:0,y:Math.floor(this.sys.game.config.height/2),oriX:i.jugador.oriX,oriY:i.jugador.oriY}),this.botoninicio=new x(this,{left:Math.floor(this.sys.game.config.width/2),top:Math.floor(this.sys.game.config.height/1.3),id:"boton-nueva-partida",scX:.6,scY:.5,angle:1,originX:.5,originY:.5,texto:" New Game ",nextScene:"PreGame"}),this.txt=new a(this,{x:Math.floor(this.sys.game.config.width/2),y:0,txt:" PinguClon ",size:100,color:"#ffa",style:"bold",stroke:"#1ca",sizeStroke:16,shadowOsx:2,shadowOsy:2,shadowColor:"#111",bool1:!1,bool2:!0,origin:[.5,.5],elastic:Math.floor(this.sys.game.config.height/4),dura:3e3})}preload(){}create(){this.add.image(0,0,"fondo").setOrigin(0,0).setDepth(i.depth.fondo),this.jugador.create(),this.txt.create(),this.add.text(Math.floor(this.sys.game.config.width/4),Math.floor(this.sys.game.config.height/1.04),"Based on classic arcade game Pengo of Sega 1982",{fontSize:"16px",color:"#9ff",align:"justify",fontFamily:"Arial"}),this.add.timeline([{at:1800,run:()=>{this.botoninicio.create("PreGame",!1)}}]).play(),b(this.marioTuberias,!1,.6),console.log(this.txt)}update(){this.jugador.update()}}class S{constructor(e){this.relatedScene=e}create(){this.tile=this.relatedScene.physics.add.group();const e=i.getNivel();for(let t=0;t<l.array_levels[e].length;t++)for(let s=0;s<l.array_levels[e][t].length;s++){const o=l.array_levels[e][t][s];this.elegir_tilesNiveles(o,t,s)}this.tile.children.iterate(((e,t)=>{e.setScale(.75).setImmovable(!0).refreshBody().setDepth(i.depth.bloques),e.setData("id",t),e.setData("vel-x",0).setData("vel-y",0)})),console.log(this.tile)}update(){this.tile.children.iterate(((e,t)=>{0===e.getData("vel-x")&&0===e.getData("vel-y")||(e.setX(e.x+e.getData("vel-x")),e.setY(e.y+e.getData("vel-y")))}))}static check_colision(e,t){const s=i.getNivel();return 9===l.array_levels[s][t][e]}elegir_tilesNiveles(e,t,s){6!==e&&this.tile.create(s*i.tileXY.x,t*i.tileXY.y,`tile${e}`)}set_idFormat(e){const t=i.getNivel(),s=Math.floor(e/i.matrixLevels.array_levels[t][0].length);return[s,e-s*i.matrixLevels.array_levels[t][0].length]}get(){return this.tile}}class D{constructor(e){this.relatedScene=e}create(e,t,s){this.broken=this.relatedScene.physics.add.sprite(e,t,"tile-broken",0),this.broken.setScale(.75).setImmovable(!0),this.broken.setDepth(i.depth.bloques).setVisible(!0),s&&this.relatedScene.anims.create({key:"broken-block-anim",frames:this.relatedScene.anims.generateFrameNumbers("tile-broken",{frames:[0,1,2,3,4,5]}),frameRate:5,hideOnComplete:!0}),this.broken.play("broken-block-anim",!0),console.log(this.broken)}get(){return this.broken}}class k{constructor(e){this.relatedScene=e}create(){const e=["diamond_","prism_","ruby_","square_",15,6,6,14];i.getNivel()>1&&this.anims.remove("jewels-anim"),this.relatedScene.anims.create({key:"jewels-anim",frames:this.relatedScene.anims.generateFrameNames("tiles-jewels",{prefix:e[3],end:e[7],zeroPad:4}),frameRate:20,repeat:-1}),this.jewels=this.relatedScene.physics.add.group();for(let t=0;t<3;t++){const e=i.getNivel(),t=l.array_levels[e];let s,o;do{s=Phaser.Math.Between(1,t[0].length-2),o=Phaser.Math.Between(1,t.length-2)}while(6!==t[o][s]||o===i.jugador.posIniY&&s===i.jugador.posIniX);this.jewels.create(s*i.tileXY.x,o*i.tileXY.y,"tiles-jewels","square_0000").setImmovable(!0).refreshBody().setDepth(i.depth.bloques).setScale(.75)}this.jewels.children.iterate(((e,t)=>{e.setData("id",t),e.setData("vel-x",0).setData("vel-y",0)})),console.log(this.jewels)}update(){this.jewels.children.iterate(((e,t)=>{0===e.getData("vel-x")&&0===e.getData("vel-y")||(e.setX(e.x+e.getData("vel-x")),e.setY(e.y+e.getData("vel-y")))}))}get(){return this.jewels}}class X{constructor(e,t){this.relatedScene=e,this.datos=t}create(){const{x:e,y:t,size:s,txt:o,color:a,strokeColor:r,id:n}=this.datos;let l="";0===n&&(l=`${o}${i.getPuntos()}`),1===n&&(l=`${o}${i.getNivel()}`),2===n&&(l=`${o}${i.getRecord()}`),this.marcador=this.relatedScene.add.text(e,t,l,{fontSize:s+"px",fill:a,fontFamily:"verdana, arial, sans-serif",fontStyle:"bold"}),this.marcador.setStroke(r,16).setShadow(2,2,"#111111",2,!1,!0),console.log(this.marcador)}update(e,t){this.marcador.setText(`${e}${t}`)}get(){return this.marcador}}class M{constructor(e,t){this.relatedScene=e,this.args=t}create(){const{left:e,top:t,id:s,scX:o,scY:r,angle:n,originX:l,originY:h,alpha:d,texto:c}=this.args;this.isDown=!1,this.boton=this.relatedScene.add.sprite(e,t,s).setInteractive(),this.boton.setOrigin(l,h).setScale(o,r).setAngle(n).setAlpha(d),this.boton.setDepth(i.depth.botones),this.txt=new a(this.relatedScene,{x:e,y:t,txt:c,size:30,color:"#fb1",style:"bold",stroke:"#f81",sizeStroke:8,shadowOsx:2,shadowOsy:2,shadowColor:"#111111",bool1:!1,bool2:!0,origin:[.5,.5],elastic:!1,dura:0}),this.txt.create(),this.txt.get().setDepth(i.depth.mobileControls).setAlpha(d+.1).setScale(1),this.boton.on("pointerover",(()=>{this.boton.setScale(o+.1,r+.1)})),this.boton.on("pointerout",(()=>{this.boton.setScale(o,r)})),this.boton.on("pointerdown",(()=>{this.isDown=!0})),this.boton.on("pointerup",(()=>{this.isDown=!1}))}get(){return this.boton}}class Y extends s.Scene{constructor(){super("Game")}init(){i.setGameOver(!1),this.set_pausaInicial(2800),this.bloques=new S(this),this.brokenblock=new D(this),this.jewels=new k(this),this.jugador=new h(this,{x:i.jugador.posIniX*i.tileXY.x,y:i.jugador.posIniY*i.tileXY.y,oriX:i.jugador.oriX,oriY:i.jugador.oriY}),this.botonfire=new M(this,{left:Math.floor(this.sys.game.config.width/1.1),top:-500,id:"boton-fire-joystick",scX:.6,scY:1.1,angle:0,originX:.5,originY:.5,alpha:.6,texto:"Push"}),this.instanciar_marcadores()}preload(){}create(){this.add.image(0,0,"fondo").setScale(1.48,1.68).setDepth(i.depth.fondo).setOrigin(0,0),this.set_sonidos(),this.set_cameras(),this.set_cameras_controles(),this.set_cameras_marcadores(),this.bloques.create(),this.brokenblock.create(0,0,!0),this.jewels.create(),this.jugador.create(),this.marcadorPtos.create(),this.marcadorNivel.create(),this.marcadorHi.create(),this.botonfullscreen.create(),this.botonesc.create(),this.rexVirtualJoystick(),this.hideMobileControls(),this.cameras.main.startFollow(this.jugador.get()),this.set_colliders()}update(){i.pausas.inicial||i.isGameOver()||(this.bloques.update(),this.jewels.update(),this.jugador.update())}set_pausaInicial(e){i.setPausaInicial(!0),this.txtpreparado=new a(this,{x:Math.floor(this.sys.game.config.width/2),y:0,txt:" Ready! ",size:78,color:"#ffa",style:"bold",stroke:"#af1",sizeStroke:16,shadowOsx:2,shadowOsy:2,shadowColor:"#111111",bool1:!1,bool2:!0,origin:[.5,.5],elastic:Math.floor(this.sys.game.config.height/2),dura:2800}),this.txtpreparado.create(),this.txtpreparado.get().setDepth(i.depth.textos),this.add.timeline([{at:e-300,run:()=>{b(i.audio.musicaFondo,!0,.6)}},{at:e,run:()=>{i.setPausaInicial(!1),this.txtpreparado.get().setVisible(!1),this.set_txtGo()}}]).play(),console.log(this.txtpreparado)}set_txtGo(){const e=new a(this,{x:Math.floor(this.sys.game.config.width/2),y:Math.floor(this.sys.game.config.height/2),txt:" Go! ",size:90,color:"#ffa",style:"bold",stroke:"#4f1",sizeStroke:16,shadowOsx:2,shadowOsy:2,shadowColor:"#111111",bool1:!1,bool2:!0,origin:[.5,.5],elastic:!1,dura:0});e.create(),e.get().setDepth(i.depth.textos),this.tweens.add({targets:e.get(),alpha:0,duration:2200})}texto_enhorabuena(){this.txtcongrats=new a(this,{x:this.jugador.get().x,y:0,txt:" Congratulations! ",size:70,color:"#ffa",style:"bold",stroke:"#5f1",sizeStroke:16,shadowOsx:2,shadowOsy:2,shadowColor:"#111111",bool1:!1,bool2:!0,origin:[.5,.5],elastic:this.jugador.get().y-i.tileXY.y,dura:3e3}),this.txtcongrats.create(),this.txtcongrats.get().setDepth(i.getDepth().textos)}set_colliders(){this.physics.add.collider(this.jugador.get(),this.bloques.get(),g,null,this),this.physics.add.collider(this.jugador.get(),this.jewels.get(),u,null,this),this.physics.add.collider(this.bloques.get(),this.bloques.get(),m,null,this),this.physics.add.collider(this.bloques.get(),this.jewels.get(),p,null,this),this.physics.add.collider(this.jewels.get(),this.bloques.get(),f,null,this)}rexVirtualJoystick(){this.joyStick=this.plugins.get("rexvirtualjoystickplugin").add(this,{x:90,y:this.sys.game.config.height-50,radius:60,base:this.add.circle(0,0,60,8947848,.4),thumb:this.add.circle(0,0,30,13421772,.7),dir:"4dir",fixed:!0,enable:!0}),console.log(this.joyStick),this.joystickCursors=this.joyStick.createCursorKeys()}hideMobileControls(){console.log(i.controlElegido),i.controlElegido.mobile||this.joyStick.setVisible(!1)}set_cameras(){this.cameras.main.setBounds(0,-Math.floor(i.tileXY.y/2),Math.floor(this.sys.game.config.width*i.screen.escBoundsX),Math.floor(this.sys.game.config.height*i.screen.escBoundsY+Math.floor(i.tileXY.y/2))),this.physics.world.setBounds(0,-Math.floor(i.tileXY.y/2),Math.floor(this.sys.game.config.width*i.screen.escBoundsX),Math.floor(this.sys.game.config.height*i.screen.escBoundsY+Math.floor(i.tileXY.y/2)))}set_cameras_controles(){var{x:e,y:t,ancho:s,alto:o,scrollX:a,scrollY:r}=i.getCameraControles();this.mapa_controles=this.cameras.add(e,t,s,o).setZoom(.9).setName("view-controls").setAlpha(1).setOrigin(0,0),this.mapa_controles.scrollX=a,this.mapa_controles.scrollY=r}set_cameras_marcadores(){var{x:e,y:t,ancho:s,alto:o,scrollX:a,scrollY:r}=i.getCameraScores();this.mapa_scores=this.cameras.add(e,t,s,o).setZoom(.6).setName("view-scores").setAlpha(1).setOrigin(0,0),this.mapa_scores.scrollX=a,this.mapa_scores.scrollY=r}instanciar_marcadores(){const e=this.sys.game.config.width;this.sys.game.config.height;this.jugadorshowvidas=new d(this,{left:Math.floor(1.4*e),top:-90}),this.marcadorPtos=new X(this,{x:10,y:-99,size:40,txt:i.getTxtScore(),color:"#fff",strokeColor:"#af1",id:0}),this.marcadorNivel=new X(this,{x:Math.floor(e/2),y:-99,size:40,txt:" Level: ",color:"#ff5",strokeColor:"#16d",id:1}),this.marcadorHi=new X(this,{x:Math.floor(e/1.2),y:-99,size:40,txt:" Record: ",color:"#fff",strokeColor:"#af1",id:2}),this.botonfullscreen=new j(this,{x:Math.floor(1.55*e),y:-92,id:"boton-fullscreen",orX:0,orY:0,scX:1.2,scY:.8,ang:0}),this.botonesc=new v(this,{left:Math.floor(1.42*e),top:-73,id:"boton-fire-joystick",scX:.5,scY:.5,angle:0,originX:.5,originY:.5,texto:"Music",nextScene:""})}set_sonidos(){this.sonido_getReady=this.sound.add("get-ready"),b(this.sonido_getReady,!1,.9),this.sonido_ziuuu=this.sound.add("ziuuu1"),this.sonido_crash=this.sound.add("crash"),i.audio.musicaFondo=this.sound.add("musica-fondo")}}class _{constructor(e,t){this.relatedScene=e,this.args=t}create(){const{left:e,top:t,frame:s,scale:o,texto:r,id:n}=this.args;this.radiobutton=this.relatedScene.add.sprite(e,t,"radio-buttons").setInteractive(),this.radiobutton.setOrigin(0,.5).setScale(o).setDepth(i.depth.textos).setFrame(s),this.radiobutton.setData("id",n),this.txt=new a(this.relatedScene,{x:e+60,y:t,txt:r,size:50,color:"#ffa",style:"bold",stroke:"#1fb",sizeStroke:16,shadowOsx:2,shadowOsy:2,shadowColor:"#111",bool1:!1,bool2:!0,origin:[0,.5],elastic:!1,dura:0}),this.txt.create(),this.radiobutton.on("pointerover",(()=>{this.txt.get().setScale(o+.1),this.radiobutton.setScale(o+.1)})),this.radiobutton.on("pointerout",(()=>{this.txt.get().setScale(o),this.radiobutton.setScale(o)})),this.radiobutton.on("pointerdown",(e=>{this.relatedScene.radiobuttons.forEach((e=>e.get().setFrame(0))),this.radiobutton.setFrame(1),Object.keys(i.controlElegido).forEach((e=>{i.controlElegido[e]=!1})),i.controlElegido[this.radiobutton.getData("id")]=!0,console.log(i.controlElegido.mobile,i.controlElegido.teclado)}))}get(){return this.radiobutton}}class O extends s.Scene{constructor(){super("PreGame")}init(){i.setPuntos(0),i.setNivel(1),i.setVidas(3),i.setGameOver(!1),i.setNivelSuperado(!1),i.controlElegido.mobile=!1,i.controlElegido.teclado=!0,this.botoninicio=new x(this,{left:Math.floor(this.sys.game.config.width/2),top:Math.floor(this.sys.game.config.height/1.3),id:"boton-nueva-partida",scX:.6,scY:.5,angle:1,originX:.5,originY:.5,texto:" Start ",nextScene:"Game"}),this.radiobuttons=[],this.radiobuttons.push(new _(this,{left:Math.floor(this.sys.game.config.width/15),top:Math.floor(this.sys.game.config.height/4),frame:1,scale:1,texto:" Keyboard cursors ",id:"teclado"})),this.radiobuttons.push(new _(this,{left:Math.floor(this.sys.game.config.width/15),top:Math.floor(this.sys.game.config.height/2.6),frame:0,scale:1,texto:" Mobile controls ",id:"mobile"}))}create(){this.add.image(0,0,"fondo").setDepth(i.depth.fondo).setOrigin(0,0),this.radiobuttons.forEach((e=>e.create())),this.botoninicio.create("Game",!1)}}class P extends Phaser.Scene{constructor(){super({key:"Congratulations"})}init(){this.botoninicio=new x(this)}create(){this.add.image(0,0,"fondo").setOrigin(0,0),this.incremento_nivel=i.getNivel()+1,i.setNivelSuperado(!1),this.sonido_intermision=this.sound.add("aliens-atmos"),this.txt=new a(this,{x:Math.floor(this.sys.game.config.width/2),y:Math.floor(this.sys.game.config.height/3.5),txt:" Level Up! ",size:86,color:"#ffa",style:"bold",stroke:"#1cb",sizeStroke:16,shadowOsx:2,shadowOsy:2,shadowColor:"#111111",bool1:!1,bool2:!0,origin:[.5,.5],elastic:!1,dura:0}),this.txt.create(),this.txt.get().setDepth(i.depth.textos).setAlpha(1),this.timeline=this.add.timeline([{at:3200,run:()=>{i.setNivel(this.incremento_nivel),this.botoninicio.create("Game",!1)}}]),this.timeline.play(),b(this.sonido_intermision,!1,.8),console.log(this.txt)}}const C={type:Phaser.AUTO,width:800,height:550,parent:"game-container",backgroundColor:"#655500",scale:{mode:Phaser.Scale.FIT,autoCenter:Phaser.Scale.CENTER_BOTH},physics:{default:"arcade",arcade:{debug:!1}},scene:[r,n,w,O,Y,P]};new Phaser.Game(C);
